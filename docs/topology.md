# INC 1-2-4 拓扑结构

## 网络拓扑图

```
                        ┌─────────────────────┐
                        │      Switch0        │
                        │      (Spine)        │
                        │   192.168.0.19      │
                        │                     │
                        │ eth1        eth2    │
                        │ 172.16.0.21 10.10.0.14
                        └────────┬───────┬────┘
                                 │       │
              172.16.0.0/16 ─────┘       └───── 10.10.0.0/16
                                 │       │
                    ┌────────────┘       └────────────┐
                    │                                 │
           ┌────────┴────────┐               ┌───────┴─────────┐
           │    Switch1      │               │    Switch2      │
           │    (Leaf1)      │               │    (Leaf2)      │
           │  192.168.0.6    │               │  192.168.0.24   │
           │                 │               │                 │
           │ eth1      eth2  │               │ eth1      eth2  │
           │172.16.0.5 10.1.1.25             │10.10.0.7  10.2.1.18
           └───┬─────────┬───┘               └───┬─────────┬───┘
               │         │                       │         │
    10.1.1.0/24│         │            10.2.1.0/24│         │
               │         │                       │         │
         ┌─────┴───┐ ┌───┴─────┐           ┌─────┴───┐ ┌───┴─────┐
         │  pku1   │ │  pku2   │           │  pku3   │ │  pku4   │
         │ rank=0  │ │ rank=1  │           │ rank=2  │ │ rank=3  │
         │10.1.1.21│ │10.1.1.5 │           │10.2.1.7 │ │10.2.1.12│
         └─────────┘ └─────────┘           └─────────┘ └─────────┘
```

## 连接表

### Switch0 (Spine)

| conn_id | 对端 | 本地 IP | 对端 IP | 类型 |
|---------|------|---------|---------|------|
| 0 | Switch1 | 172.16.0.21 | 172.16.0.5 | switch |
| 1 | Switch2 | 10.10.0.14 | 10.10.0.7 | switch |

### Switch1 (Leaf1)

| conn_id | 对端 | 本地 IP | 对端 IP | 类型 |
|---------|------|---------|---------|------|
| 0 | Switch0 | 172.16.0.5 | 172.16.0.21 | switch |
| 1 | pku1 | 10.1.1.25 | 10.1.1.21 | host |
| 2 | pku2 | 10.1.1.25 | 10.1.1.5 | host |

### Switch2 (Leaf2)

| conn_id | 对端 | 本地 IP | 对端 IP | 类型 |
|---------|------|---------|---------|------|
| 0 | Switch0 | 10.10.0.7 | 10.10.0.14 | switch |
| 1 | pku3 | 10.2.1.18 | 10.2.1.7 | host |
| 2 | pku4 | 10.2.1.18 | 10.2.1.12 | host |

## Rank 映射

| rank | Host | 数据网 IP | 所属 Switch |
|------|------|-----------|-------------|
| 0 | pku1 | 10.1.1.21 | Switch1 (conn=1) |
| 1 | pku2 | 10.1.1.5 | Switch1 (conn=2) |
| 2 | pku3 | 10.2.1.7 | Switch2 (conn=1) |
| 3 | pku4 | 10.2.1.12 | Switch2 (conn=2) |

## Switch 编号

| Switch ID | 角色 | 管理网 IP | is_root | 运行节点 |
|-----------|------|-----------|---------|----------|
| 0 | Spine | 192.168.0.19 | 1 | switch |
| 1 | Leaf1 | 192.168.0.6 | 0 | vm1 |
| 2 | Leaf2 | 192.168.0.24 | 0 | vm2 |
