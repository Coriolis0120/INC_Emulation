---- VM1 Log ----
=== AllReduce Test Configuration ===
world_size: 2
master_addr: 192.168.0.6
rank: 0
data_count: 4096
====================================

Rank 0: Initialized input data (first 5 elements): 0 1 2 3 4 
Rank 0: Creating communication group...
devices num 1
rxe_eth1

===== Device Attributes =====
Maximum QPs: 65536
Maximum CQs: 16384
Maximum MRs: 4096
Maximum PDs: 32764
Maximum QP WR: 16384
Maximum CQ entries: 32767
Maximum MR size: 18446744073709551615 bytes
=============================


===== Port Attributes =====
Port state: 4 (0=DOWN, 1=INIT, 2=ARMED, 3=ACTIVE)
Physical state: 5
LID: 0x0000 (0)
Active MTU: 3 (256*2^3 = 2048 bytes)
Max MTU: 5 (256*2^5 = 8192 bytes)
Active speed: 1
Active width: 1 (1=1x, 2=4x, 4=8x, 8=12x)
GID table length: 1024
Link layer: 2 (0=IB, 1=Ethernet)
============================

my ip: 172.16.0.5
controller ip: 192.168.0.3 
connect to ranks success.
connect to controller success.
group id: 1!
Rank 0: Creating communicator...
my QP number = 18
rank0 qp num 18
rank1 qp num 107
File received and saved to: /root/NetLab/topology.yaml
send file to fd: 6 succeed.
parse yaml
Remote QP number = 0xb
Remote GID = 00:00:00:00:00:00:00:00:00:00:ff:ff:ac:10:00:15
ret of init 0
mtu: 3
ret of rtr 0
qp status: 2
ret of rts 0
Rank 0: Starting AllReduce operation...
i: 0, post recv ret 0
i: 1, post recv ret 0
i: 2, post recv ret 0
i: 3, post recv ret 0
send success
send success
receive success
recv[0][0]: net=0x00000000, host=0, stored=0
recv[0][1]: net=0x01000000, host=1, stored=1
recv[0][2]: net=0x06000000, host=6, stored=6
send success
receive success
recv[1][0]: net=0x000c0000, host=3072, stored=3072
recv[1][1]: net=0x030c0000, host=3075, stored=3075
recv[1][2]: net=0x060c0000, host=3078, stored=3078
send success
receive success
recv[2][0]: net=0x00180000, host=6144, stored=6144
recv[2][1]: net=0x03180000, host=6147, stored=6147
recv[2][2]: net=0x06180000, host=6150, stored=6150
receive success
recv[3][0]: net=0x00240000, host=9216, stored=9216
recv[3][1]: net=0x03240000, host=9219, stored=9219
recv[3][2]: net=0x06240000, host=9222, stored=9222
AllReduce operation completed, Time taken: 15.400000 milliseconds

=== Rank 0: Verifying AllReduce Result ===
Expected multiplier: 3 (sum of 1..2)

First 10 elements:
  idx 0: in_data=0, dst_data=0, expected=0 ✓
  idx 1: in_data=1, dst_data=1, expected=3 ✗

ERROR: Mismatch detected!
  ERROR at idx 1: got 1, expected 3
  idx 2: in_data=2, dst_data=6, expected=6 ✓
  idx 3: in_data=3, dst_data=9, expected=9 ✓
  idx 4: in_data=4, dst_data=12, expected=12 ✓
  idx 5: in_data=5, dst_data=15, expected=15 ✓
  idx 6: in_data=6, dst_data=18, expected=18 ✓
  idx 7: in_data=7, dst_data=21, expected=21 ✓
  idx 8: in_data=8, dst_data=24, expected=24 ✓
  idx 9: in_data=9, dst_data=27, expected=27 ✓

FAILED: Result verification failed!

=== Test Summary ===
Operation: AllReduce
World size: 2
Current rank: 0
Data count: 4096 elements
====================

Rank 0: Test completed.
