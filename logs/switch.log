---- Switch Log ----
=== INC Switch (Refactored Version) ===
Controller IP: 192.168.0.3
Switch context initialized: ID=0, PSN slots=300, Thread pool size=4
Connecting to controller...
[Controller] Connecting to 192.168.0.3:52311...
[Controller] Connected successfully
Controller connection established
Switch started successfully
Waiting for controller commands...
[Controller] Communication thread started, waiting for YAML...
[Controller] YAML size: 2170 bytes
[Controller] Received YAML:
world_size: 2
switch:
  id: 0
  connections:
    - conn_id: 0
      is_switch: false
      peer_id: 0
      my_ip: 172.16.0.21
      my_mac: fa:16:3e:9a:26:99
      my_name: eth1
      my_port: 4791
      my_qp: 11
      peer_ip: 172.16.0.5
      peer_mac: fa:16:3e:87:09:4c
      peer_port: 4791
      peer_qp: 18
    - conn_id: 1
      is_switch: false
      peer_id: 1
      my_ip: 10.10.0.14
      my_mac: fa:16:3e:3d:ab:78
      my_name: eth2
      my_port: 4791
      my_qp: 12
      peer_ip: 10.10.0.7
      peer_mac: fa:16:3e:7b:25:36
      peer_port: 4791
      peer_qp: 133
  rules:
    - src_ip: 172.16.0.5
      dst_ip: 172.16.0.21
      primitive: 1
      primitive_param: -1
      conn_id: 0
      direction: 0
      root: true
      ack_conn: 0
      out_conns:
        - 0
        - 1
    - src_ip: 10.10.0.7
      dst_ip: 10.10.0.14
      primitive: 1
      primitive_param: -1
      conn_id: 1
      direction: 0
      root: true
      ack_conn: 1
      out_conns:
        - 0
        - 1
    - src_ip: 172.16.0.5
      dst_ip: 172.16.0.21
      primitive: 2
      primitive_param: 0
      conn_id: 0
      direction: 0
      root: true
      ack_conn: 0
      out_conns:
        - 0
    - src_ip: 10.10.0.7
      dst_ip: 10.10.0.14
      primitive: 2
      primitive_param: 0
      conn_id: 1
      direction: 0
      root: true
      ack_conn: 1
      out_conns:
        - 0
    - src_ip: 172.16.0.5
      dst_ip: 172.16.0.21
      primitive: 2
      primitive_param: 1
      conn_id: 0
      direction: 0
      root: true
      ack_conn: 0
      out_conns:
        - 1
    - src_ip: 10.10.0.7
      dst_ip: 10.10.0.14
      primitive: 2
      primitive_param: 1
      conn_id: 1
      direction: 0
      root: true
      ack_conn: 1
      out_conns:
        - 1
    - src_ip: 172.16.0.5
      dst_ip: 172.16.0.21
      primitive: 3
      primitive_param: 0
      conn_id: 0
      direction: 0
      root: true
      ack_conn: 0
      out_conns:
        - 1
    - src_ip: 10.10.0.7
      dst_ip: 10.10.0.14
      primitive: 3
      primitive_param: 1
      conn_id: 1
      direction: 0
      root: true
      ack_conn: 1
      out_conns:
        - 0
[YAML] ========== Parsing YAML ==========
[YAML] switch_id: 0
PSN states reset
[YAML] Parsing connections...
[YAML] Connection 0: eth1 (172.16.0.21) <-> 172.16.0.5, is_switch=0, peer_id=0
[YAML] Connection 1: eth2 (10.10.0.14) <-> 10.10.0.7, is_switch=0, peer_id=1
[YAML] Total connections parsed: 2
[YAML] Parsing rules...
[YAML] Rule 0: 172.16.0.5 -> 172.16.0.21, primitive=1, param=-1, dir=UP, root=1, out_cnt=2
[YAML] Rule 1: 10.10.0.7 -> 10.10.0.14, primitive=1, param=-1, dir=UP, root=1, out_cnt=2
[YAML] Rule 2: 172.16.0.5 -> 172.16.0.21, primitive=2, param=0, dir=UP, root=1, out_cnt=1
[YAML] Rule 3: 10.10.0.7 -> 10.10.0.14, primitive=2, param=0, dir=UP, root=1, out_cnt=1
[YAML] Rule 4: 172.16.0.5 -> 172.16.0.21, primitive=2, param=1, dir=UP, root=1, out_cnt=1
[YAML] Rule 5: 10.10.0.7 -> 10.10.0.14, primitive=2, param=1, dir=UP, root=1, out_cnt=1
[YAML] Rule 6: 172.16.0.5 -> 172.16.0.21, primitive=3, param=0, dir=UP, root=1, out_cnt=1
[YAML] Rule 7: 10.10.0.7 -> 10.10.0.14, primitive=3, param=1, dir=UP, root=1, out_cnt=1
[YAML] Total rules parsed: 8
[YAML] ========== YAML parsing complete ==========
[Controller] Routing table loaded: 8 rules, 2 connections
[Controller] Config applied, num_receivers=2
[Receiver] Starting 2 receiver threads...
[Receiver] Connection 0: device=eth1, filter=udp port 4791 and src host 172.16.0.5
[Receiver] Connection 1: device=eth2, filter=udp port 4791 and src host 10.10.0.7
[Receiver] Thread 0 started for device eth1
[Receiver] Thread 1 started for device eth2
[SWITCH] conn_id=0: Received packet PSN=0, opcode=0x05
[SWITCH] Immediate Data: imm=0x00005000, dest_rank=0, prim=1, op=1, dtype=0
[SWITCH] Parsed: operation_type=2, root_rank=0, is_control=1, ctrl_psn=0
[SWITCH] Control message received from conn 0, PSN=0
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] forwarding: psn=0, type=1, len=0, out_cnt=1
[SWITCH] Control message ACK sent, ePSN[0] updated to 1
[SWITCH] conn_id=0: Received packet PSN=1, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=1 from conn 0
[SWITCH] forwarding: psn=1, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=1, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=0: Received packet PSN=2, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=2 from conn 0
[SWITCH] forwarding: psn=2, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=2, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=0: Received packet PSN=3, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=3 from conn 0
[SWITCH] forwarding: psn=3, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=3, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=0: Received packet PSN=4, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=4 from conn 0
[SWITCH] forwarding: psn=4, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=4, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=0: Received packet PSN=5, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=5 from conn 0
[SWITCH] forwarding: psn=5, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=5, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=0: Received packet PSN=6, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=6 from conn 0
[SWITCH] forwarding: psn=6, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=6, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=0: Received packet PSN=7, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=7 from conn 0
[SWITCH] forwarding: psn=7, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=7, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=0: Received packet PSN=8, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=8 from conn 0
[SWITCH] forwarding: psn=8, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=8, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=1: Received packet PSN=0, opcode=0x05
[SWITCH] Immediate Data: imm=0x00005000, dest_rank=0, prim=1, op=1, dtype=0
[SWITCH] Parsed: operation_type=2, root_rank=0, is_control=1, ctrl_psn=0
[SWITCH] Control message received from conn 1, PSN=0
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] forwarding: psn=0, type=1, len=0, out_cnt=1
[SWITCH] Control message ACK sent, ePSN[1] updated to 1
[SWITCH] conn_id=1: Received packet PSN=1, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=1 from conn 1
[SWITCH] forwarding: psn=1, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=1, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=1, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=1, send_PSN=0 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=1: Received packet PSN=2, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=2 from conn 1
[SWITCH] forwarding: psn=2, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=2, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=2, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=2, send_PSN=1 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=1: Received packet PSN=3, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=3 from conn 1
[SWITCH] forwarding: psn=3, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=3, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=3, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=3, send_PSN=2 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=1: Received packet PSN=4, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=4 from conn 1
[SWITCH] forwarding: psn=4, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=4, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=4, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=4, send_PSN=3 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=1: Received packet PSN=5, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=5 from conn 1
[SWITCH] forwarding: psn=5, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=5, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=5, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=5, send_PSN=4 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=1: Received packet PSN=6, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=6 from conn 1
[SWITCH] forwarding: psn=6, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=6, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=6, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=6, send_PSN=5 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=1: Received packet PSN=7, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=7 from conn 1
[SWITCH] forwarding: psn=7, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=7, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=7, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=7, send_PSN=6 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=1: Received packet PSN=8, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=8 from conn 1
[SWITCH] forwarding: psn=8, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=8, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=8, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=8, send_PSN=7 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=0: Received packet PSN=0, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=0
[SWITCH] conn_id=0: Received packet PSN=1, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=1
[SWITCH] conn_id=0: Received packet PSN=2, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=2
[SWITCH] conn_id=0: Received packet PSN=3, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=3
[SWITCH] conn_id=1: Received packet PSN=9, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=9 from conn 1
[SWITCH] forwarding: psn=9, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=9, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=1: Received packet PSN=10, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=10 from conn 1
[SWITCH] forwarding: psn=10, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=10, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=1: Received packet PSN=11, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=11 from conn 1
[SWITCH] forwarding: psn=11, type=1, len=0, out_cnt=1
[SWITCH] conn_id=0: Received packet PSN=9, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] aggregate: conn_id=1, PSN=11, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=1: Received packet PSN=12, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=12 from conn 1
[SWITCH] forwarding: psn=12, type=1, len=0, out_cnt=1
[SWITCH] Upstream data PSN=9 from conn 0
[SWITCH] forwarding: psn=9, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=12, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] aggregate: conn_id=0, PSN=9, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=9, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=9, send_PSN=8 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=0: Received packet PSN=10, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=10 from conn 0
[SWITCH] forwarding: psn=10, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=10, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=10, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=10, send_PSN=9 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=0: Received packet PSN=11, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=11 from conn 0
[SWITCH] forwarding: psn=11, type=1, len=0, out_cnt=1
[SWITCH] conn_id=1: Received packet PSN=13, opcode=0x00
[SWITCH] aggregate: conn_id=0, PSN=11, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=13 from conn 1
[SWITCH] forwarding: psn=13, type=1, len=0, out_cnt=1
[SWITCH] Aggregation complete for PSN=11, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=11, send_PSN=10 via conn 0
[SWITCH] aggregate: conn_id=1, PSN=13, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=1: Received packet PSN=14, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=14 from conn 1
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] forwarding: psn=14, type=1, len=0, out_cnt=1
[SWITCH] conn_id=0: Received packet PSN=12, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=12 from conn 0
[SWITCH] forwarding: psn=12, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=14, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] aggregate: conn_id=0, PSN=12, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=12, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=12, send_PSN=11 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=0: Received packet PSN=4, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=4
[SWITCH] conn_id=1: Received packet PSN=15, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=15 from conn 1
[SWITCH] forwarding: psn=15, type=1, len=0, out_cnt=1
[SWITCH] conn_id=0: Received packet PSN=5, opcode=0x11
[SWITCH] aggregate: conn_id=1, PSN=15, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] conn_id=1: Received packet PSN=16, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=16 from conn 1
[SWITCH] forwarding: psn=16, type=1, len=0, out_cnt=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=5
[SWITCH] aggregate: conn_id=1, PSN=16, len=256, degree=1/2, op_type=2, root_rank=0
[SWITCH] conn_id=0: Received packet PSN=6, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=6
[SWITCH] conn_id=0: Received packet PSN=7, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=7
[SWITCH] conn_id=0: Received packet PSN=13, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=13 from conn 0
[SWITCH] forwarding: psn=13, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=13, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=13, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=13, send_PSN=12 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=0: Received packet PSN=14, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=14 from conn 0
[SWITCH] forwarding: psn=14, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=14, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=14, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=14, send_PSN=13 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=0: Received packet PSN=15, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=15 from conn 0
[SWITCH] forwarding: psn=15, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=15, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=15, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=15, send_PSN=14 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=0: Received packet PSN=16, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=16 from conn 0
[SWITCH] forwarding: psn=16, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=16, len=256, degree=2/2, op_type=2, root_rank=0
[SWITCH] Aggregation complete for PSN=16, op_type=2
[SWITCH] Reduce: sending to root_rank=0, recv_PSN=16, send_PSN=15 via conn 0
[SWITCH] Reduce result sent to rank 0 via conn 0
[SWITCH] conn_id=0: Received packet PSN=8, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=8
[SWITCH] conn_id=0: Received packet PSN=9, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=9
[SWITCH] conn_id=0: Received packet PSN=10, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=10
[SWITCH] conn_id=0: Received packet PSN=11, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 0 for PSN=11
[SWITCH] conn_id=1: Received packet PSN=17, opcode=0x05
[SWITCH] Immediate Data: imm=0xFFFF1000, dest_rank=65535, prim=0, op=1, dtype=0
[SWITCH] Parsed: operation_type=1, root_rank=-1, is_control=1, ctrl_psn=17
[SWITCH] Control message received from conn 1, PSN=17
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] forwarding: psn=17, type=1, len=0, out_cnt=2
[SWITCH] Control message ACK sent, ePSN[1] updated to 18
[SWITCH] conn_id=0: Received packet PSN=12, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=12
[SWITCH] conn_id=0: Received packet PSN=13, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=13
[SWITCH] conn_id=0: Received packet PSN=14, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=14
[SWITCH] conn_id=0: Received packet PSN=15, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=15
[SWITCH] conn_id=0: Received packet PSN=17, opcode=0x05
[SWITCH] Immediate Data: imm=0xFFFF1000, dest_rank=65535, prim=0, op=1, dtype=0
[SWITCH] Parsed: operation_type=1, root_rank=-1, is_control=1, ctrl_psn=17
[SWITCH] Control message received from conn 0, PSN=17
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] forwarding: psn=17, type=1, len=0, out_cnt=2
[SWITCH] Control message ACK sent, ePSN[0] updated to 18
[SWITCH] conn_id=1: Received packet PSN=18, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=18 from conn 1
[SWITCH] forwarding: psn=18, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=18, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=19, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=19 from conn 1
[SWITCH] forwarding: psn=19, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=19, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=20, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=20 from conn 1
[SWITCH] forwarding: psn=20, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=20, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=21, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=21 from conn 1
[SWITCH] forwarding: psn=21, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=21, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=22, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=22 from conn 1
[SWITCH] forwarding: psn=22, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=22, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=23, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=23 from conn 1
[SWITCH] forwarding: psn=23, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=23, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=24, opcode=0x01
[SWITCH] conn_id=0: Received packet PSN=18, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=24 from conn 1
[SWITCH] forwarding: psn=24, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=24, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=25, opcode=0x02
[SWITCH] Upstream data PSN=18 from conn 0
[SWITCH] forwarding: psn=18, type=1, len=0, out_cnt=2
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=25 from conn 1
[SWITCH] forwarding: psn=25, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=18, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=18, op_type=1
[SWITCH] AllReduce: broadcasting PSN=18
[SWITCH] Broadcasting to conn 0: recv_PSN=18, send_PSN=16
[SWITCH] aggregate: conn_id=1, PSN=25, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] Broadcasting to conn 1: recv_PSN=18, send_PSN=0
[SWITCH] conn_id=0: Received packet PSN=19, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=19 from conn 0
[SWITCH] forwarding: psn=19, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=19, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=19, op_type=1
[SWITCH] AllReduce: broadcasting PSN=19
[SWITCH] Broadcasting to conn 0: recv_PSN=19, send_PSN=17
[SWITCH] Broadcasting to conn 1: recv_PSN=19, send_PSN=1
[SWITCH] conn_id=0: Received packet PSN=20, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=20 from conn 0
[SWITCH] forwarding: psn=20, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=20, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=20, op_type=1
[SWITCH] AllReduce: broadcasting PSN=20
[SWITCH] Broadcasting to conn 0: recv_PSN=20, send_PSN=18
[SWITCH] Broadcasting to conn 1: recv_PSN=20, send_PSN=2
[SWITCH] conn_id=0: Received packet PSN=21, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=21 from conn 0
[SWITCH] forwarding: psn=21, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=21, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=21, op_type=1
[SWITCH] AllReduce: broadcasting PSN=21
[SWITCH] Broadcasting to conn 0: recv_PSN=21, send_PSN=19
[SWITCH] Broadcasting to conn 1: recv_PSN=21, send_PSN=3
[SWITCH] conn_id=0: Received packet PSN=22, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=22 from conn 0
[SWITCH] forwarding: psn=22, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=22, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=22, op_type=1
[SWITCH] AllReduce: broadcasting PSN=22
[SWITCH] Broadcasting to conn 0: recv_PSN=22, send_PSN=20
[SWITCH] Broadcasting to conn 1: recv_PSN=22, send_PSN=4
[SWITCH] conn_id=0: Received packet PSN=23, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=23 from conn 0
[SWITCH] forwarding: psn=23, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=23, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=23, op_type=1
[SWITCH] AllReduce: broadcasting PSN=23
[SWITCH] Broadcasting to conn 0: recv_PSN=23, send_PSN=21
[SWITCH] Broadcasting to conn 1: recv_PSN=23, send_PSN=5
[SWITCH] conn_id=0: Received packet PSN=24, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=24 from conn 0
[SWITCH] forwarding: psn=24, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=24, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=24, op_type=1
[SWITCH] AllReduce: broadcasting PSN=24
[SWITCH] Broadcasting to conn 0: recv_PSN=24, send_PSN=22
[SWITCH] Broadcasting to conn 1: recv_PSN=24, send_PSN=6
[SWITCH] conn_id=0: Received packet PSN=25, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=25 from conn 0
[SWITCH] forwarding: psn=25, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=25, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=25, op_type=1
[SWITCH] AllReduce: broadcasting PSN=25
[SWITCH] Broadcasting to conn 0: recv_PSN=25, send_PSN=23
[SWITCH] Broadcasting to conn 1: recv_PSN=25, send_PSN=7
[SWITCH] conn_id=0: Received packet PSN=16, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=16
[SWITCH] conn_id=0: Received packet PSN=17, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=17
[SWITCH] conn_id=0: Received packet PSN=18, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=18
[SWITCH] conn_id=0: Received packet PSN=19, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=19
[SWITCH] conn_id=1: Received packet PSN=0, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=0
[SWITCH] conn_id=1: Received packet PSN=1, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] conn_id=0: Received packet PSN=26, opcode=0x00
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=1
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Broadcast complete for PSN=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=26 from conn 0
[SWITCH] forwarding: psn=26, type=1, len=0, out_cnt=2
[SWITCH] conn_id=1: Received packet PSN=2, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=2
[SWITCH] Broadcast complete for PSN=2
[SWITCH] aggregate: conn_id=0, PSN=26, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=3, opcode=0x11
[SWITCH] conn_id=0: Received packet PSN=27, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=27 from conn 0
[SWITCH] Upstream ACK from conn 1 for PSN=3
[SWITCH] Broadcast complete for PSN=3
[SWITCH] conn_id=1: Received packet PSN=26, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=26 from conn 1
[SWITCH] forwarding: psn=26, type=1, len=0, out_cnt=2
[SWITCH] forwarding: psn=27, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=27, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=28, opcode=0x01
[SWITCH] aggregate: conn_id=1, PSN=26, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Aggregation complete for PSN=26, op_type=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] AllReduce: broadcasting PSN=26
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=28 from conn 0
[SWITCH] forwarding: psn=28, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=28, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=29, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Broadcasting to conn 0: recv_PSN=26, send_PSN=24
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=29 from conn 0
[SWITCH] forwarding: psn=29, type=1, len=0, out_cnt=2
[SWITCH] Broadcasting to conn 1: recv_PSN=26, send_PSN=8
[SWITCH] aggregate: conn_id=0, PSN=29, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=20, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=20
[SWITCH] conn_id=0: Received packet PSN=21, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=21
[SWITCH] conn_id=1: Received packet PSN=27, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=27 from conn 1
[SWITCH] forwarding: psn=27, type=1, len=0, out_cnt=2
[SWITCH] conn_id=0: Received packet PSN=22, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=22
[SWITCH] aggregate: conn_id=1, PSN=27, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=27, op_type=1
[SWITCH] AllReduce: broadcasting PSN=27
[SWITCH] Broadcasting to conn 0: recv_PSN=27, send_PSN=25
[SWITCH] conn_id=0: Received packet PSN=23, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=23
[SWITCH] Broadcasting to conn 1: recv_PSN=27, send_PSN=9
[SWITCH] conn_id=0: Received packet PSN=30, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=30 from conn 0
[SWITCH] forwarding: psn=30, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=30, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=28, opcode=0x01
[SWITCH] conn_id=0: Received packet PSN=31, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=28 from conn 1
[SWITCH] forwarding: psn=28, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=28, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=28, op_type=1
[SWITCH] AllReduce: broadcasting PSN=28
[SWITCH] Broadcasting to conn 0: recv_PSN=28, send_PSN=26
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=31 from conn 0
[SWITCH] forwarding: psn=31, type=1, len=0, out_cnt=2
[SWITCH] Broadcasting to conn 1: recv_PSN=28, send_PSN=10
[SWITCH] aggregate: conn_id=0, PSN=31, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=32, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=32 from conn 0
[SWITCH] forwarding: psn=32, type=1, len=0, out_cnt=2
[SWITCH] conn_id=1: Received packet PSN=29, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=29 from conn 1
[SWITCH] forwarding: psn=29, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=32, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] aggregate: conn_id=1, PSN=29, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=29, op_type=1
[SWITCH] AllReduce: broadcasting PSN=29
[SWITCH] Broadcasting to conn 0: recv_PSN=29, send_PSN=27
[SWITCH] conn_id=0: Received packet PSN=33, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Broadcasting to conn 1: recv_PSN=29, send_PSN=11
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] conn_id=1: Received packet PSN=4, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=4
[SWITCH] Broadcast complete for PSN=4
[SWITCH] conn_id=1: Received packet PSN=5, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=5
[SWITCH] Broadcast complete for PSN=5
[SWITCH] Upstream data PSN=33 from conn 0
[SWITCH] conn_id=1: Received packet PSN=6, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=6
[SWITCH] Broadcast complete for PSN=6
[SWITCH] conn_id=1: Received packet PSN=7, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=7
[SWITCH] Broadcast complete for PSN=7
[SWITCH] conn_id=1: Received packet PSN=30, opcode=0x00
[SWITCH] forwarding: psn=33, type=1, len=0, out_cnt=2
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=30 from conn 1
[SWITCH] forwarding: psn=30, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=33, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=24, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=24
[SWITCH] aggregate: conn_id=1, PSN=30, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=30, op_type=1
[SWITCH] AllReduce: broadcasting PSN=30
[SWITCH] Broadcasting to conn 0: recv_PSN=30, send_PSN=28
[SWITCH] Broadcasting to conn 1: recv_PSN=30, send_PSN=12
[SWITCH] conn_id=1: Received packet PSN=31, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=31 from conn 1
[SWITCH] forwarding: psn=31, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=31, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=31, op_type=1
[SWITCH] AllReduce: broadcasting PSN=31
[SWITCH] Broadcasting to conn 0: recv_PSN=31, send_PSN=29
[SWITCH] Broadcasting to conn 1: recv_PSN=31, send_PSN=13
[SWITCH] conn_id=1: Received packet PSN=32, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=32 from conn 1
[SWITCH] forwarding: psn=32, type=1, len=0, out_cnt=2
[SWITCH] conn_id=0: Received packet PSN=25, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=25
[SWITCH] aggregate: conn_id=1, PSN=32, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=32, op_type=1
[SWITCH] AllReduce: broadcasting PSN=32
[SWITCH] Broadcasting to conn 0: recv_PSN=32, send_PSN=30
[SWITCH] conn_id=0: Received packet PSN=26, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=26
[SWITCH] Broadcasting to conn 1: recv_PSN=32, send_PSN=14
[SWITCH] conn_id=0: Received packet PSN=27, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=27
[SWITCH] conn_id=1: Received packet PSN=33, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=33 from conn 1
[SWITCH] forwarding: psn=33, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=33, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=33, op_type=1
[SWITCH] AllReduce: broadcasting PSN=33
[SWITCH] Broadcasting to conn 0: recv_PSN=33, send_PSN=31
[SWITCH] Broadcasting to conn 1: recv_PSN=33, send_PSN=15
[SWITCH] conn_id=1: Received packet PSN=8, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=8
[SWITCH] Broadcast complete for PSN=8
[SWITCH] conn_id=1: Received packet PSN=9, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=9
[SWITCH] Broadcast complete for PSN=9
[SWITCH] conn_id=1: Received packet PSN=10, opcode=0x11
[SWITCH] conn_id=0: Received packet PSN=28, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=10
[SWITCH] Broadcast complete for PSN=10
[SWITCH] conn_id=1: Received packet PSN=11, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=11
[SWITCH] Broadcast complete for PSN=11
[SWITCH] conn_id=1: Received packet PSN=12, opcode=0x11
[SWITCH] Upstream ACK from conn 0 for PSN=28
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] conn_id=0: Received packet PSN=29, opcode=0x11
[SWITCH] Upstream ACK from conn 1 for PSN=12
[SWITCH] Broadcast complete for PSN=12
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=29
[SWITCH] conn_id=1: Received packet PSN=13, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=13
[SWITCH] Broadcast complete for PSN=13
[SWITCH] conn_id=0: Received packet PSN=30, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=30
[SWITCH] conn_id=0: Received packet PSN=31, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] conn_id=1: Received packet PSN=14, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=31
[SWITCH] Upstream ACK from conn 1 for PSN=14
[SWITCH] Broadcast complete for PSN=14
[SWITCH] conn_id=1: Received packet PSN=15, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=15
[SWITCH] Broadcast complete for PSN=15
[SWITCH] conn_id=1: Received packet PSN=34, opcode=0x05
[SWITCH] Immediate Data: imm=0x00015000, dest_rank=1, prim=1, op=1, dtype=0
[SWITCH] Parsed: operation_type=2, root_rank=1, is_control=1, ctrl_psn=34
[SWITCH] Control message received from conn 1, PSN=34
[SWITCH] conn_id=0: Received packet PSN=34, opcode=0x05
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Immediate Data: imm=0x00015000, dest_rank=1, prim=1, op=1, dtype=0
[SWITCH] forwarding: psn=34, type=1, len=0, out_cnt=1
[SWITCH] Parsed: operation_type=2, root_rank=1, is_control=1, ctrl_psn=34
[SWITCH] Control message received from conn 0, PSN=34
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] forwarding: psn=34, type=1, len=0, out_cnt=1
[SWITCH] Control message ACK sent, ePSN[1] updated to 35
[SWITCH] Control message ACK sent, ePSN[0] updated to 35
[SWITCH] conn_id=0: Received packet PSN=35, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=35 from conn 0
[SWITCH] forwarding: psn=35, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=35, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=36, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] conn_id=1: Received packet PSN=35, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=35 from conn 1
[SWITCH] forwarding: psn=35, type=1, len=0, out_cnt=1
[SWITCH] Upstream data PSN=36 from conn 0
[SWITCH] forwarding: psn=36, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=35, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=35, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=35, send_PSN=16 via conn 1
[SWITCH] aggregate: conn_id=0, PSN=36, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=37, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=37 from conn 0
[SWITCH] forwarding: psn=37, type=1, len=0, out_cnt=1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] aggregate: conn_id=0, PSN=37, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=1: Received packet PSN=36, opcode=0x01
[SWITCH] conn_id=0: Received packet PSN=38, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=36 from conn 1
[SWITCH] forwarding: psn=36, type=1, len=0, out_cnt=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=36, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=36, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=36, send_PSN=17 via conn 1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=38 from conn 0
[SWITCH] forwarding: psn=38, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=38, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=0: Received packet PSN=39, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] conn_id=1: Received packet PSN=37, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=37 from conn 1
[SWITCH] forwarding: psn=37, type=1, len=0, out_cnt=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=39 from conn 0
[SWITCH] forwarding: psn=39, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=37, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=37, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=37, send_PSN=18 via conn 1
[SWITCH] aggregate: conn_id=0, PSN=39, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=40, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=40 from conn 0
[SWITCH] forwarding: psn=40, type=1, len=0, out_cnt=1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] aggregate: conn_id=0, PSN=40, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=1: Received packet PSN=38, opcode=0x02
[SWITCH] conn_id=0: Received packet PSN=41, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=38 from conn 1
[SWITCH] forwarding: psn=38, type=1, len=0, out_cnt=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] aggregate: conn_id=1, PSN=38, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=38, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=38, send_PSN=19 via conn 1
[SWITCH] Upstream data PSN=41 from conn 0
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] forwarding: psn=41, type=1, len=0, out_cnt=1
[SWITCH] conn_id=1: Received packet PSN=39, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=39 from conn 1
[SWITCH] aggregate: conn_id=0, PSN=41, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=42, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=42 from conn 0
[SWITCH] forwarding: psn=42, type=1, len=0, out_cnt=1
[SWITCH] forwarding: psn=39, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=42, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] aggregate: conn_id=1, PSN=39, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=39, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=39, send_PSN=20 via conn 1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=40, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=40 from conn 1
[SWITCH] forwarding: psn=40, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=40, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=40, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=40, send_PSN=21 via conn 1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=41, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=41 from conn 1
[SWITCH] forwarding: psn=41, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=41, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=41, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=41, send_PSN=22 via conn 1
[SWITCH] conn_id=0: Received packet PSN=43, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=43 from conn 0
[SWITCH] forwarding: psn=43, type=1, len=0, out_cnt=1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=42, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] aggregate: conn_id=0, PSN=43, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=44, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=44 from conn 0
[SWITCH] forwarding: psn=44, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=44, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=45, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=45 from conn 0
[SWITCH] forwarding: psn=45, type=1, len=0, out_cnt=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=42 from conn 1
[SWITCH] forwarding: psn=42, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=45, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=46, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=46 from conn 0
[SWITCH] forwarding: psn=46, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=42, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=42, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=42, send_PSN=23 via conn 1
[SWITCH] aggregate: conn_id=0, PSN=46, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=16, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=16
[SWITCH] Broadcast complete for PSN=16
[SWITCH] conn_id=1: Received packet PSN=17, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=17
[SWITCH] Broadcast complete for PSN=17
[SWITCH] conn_id=1: Received packet PSN=18, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=18
[SWITCH] Broadcast complete for PSN=18
[SWITCH] conn_id=1: Received packet PSN=19, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=19
[SWITCH] Broadcast complete for PSN=19
[SWITCH] conn_id=1: Received packet PSN=43, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=43 from conn 1
[SWITCH] forwarding: psn=43, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=43, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=43, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=43, send_PSN=24 via conn 1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=44, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] conn_id=0: Received packet PSN=47, opcode=0x00
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Upstream data PSN=44 from conn 1
[SWITCH] forwarding: psn=44, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=44, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=44, op_type=2
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=44, send_PSN=25 via conn 1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=47 from conn 0
[SWITCH] forwarding: psn=47, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=47, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=48, opcode=0x01
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=48 from conn 0
[SWITCH] forwarding: psn=48, type=1, len=0, out_cnt=1
[SWITCH] conn_id=1: Received packet PSN=45, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=45 from conn 1
[SWITCH] forwarding: psn=45, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=0, PSN=48, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=49, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=49 from conn 0
[SWITCH] forwarding: psn=49, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=45, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=45, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=45, send_PSN=26 via conn 1
[SWITCH] aggregate: conn_id=0, PSN=49, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=0: Received packet PSN=50, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=50 from conn 0
[SWITCH] forwarding: psn=50, type=1, len=0, out_cnt=1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] aggregate: conn_id=0, PSN=50, len=256, degree=1/2, op_type=2, root_rank=1
[SWITCH] conn_id=1: Received packet PSN=46, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=46 from conn 1
[SWITCH] forwarding: psn=46, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=46, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=46, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=46, send_PSN=27 via conn 1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=20, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=20
[SWITCH] Broadcast complete for PSN=20
[SWITCH] conn_id=1: Received packet PSN=21, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=21
[SWITCH] Broadcast complete for PSN=21
[SWITCH] conn_id=1: Received packet PSN=22, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=22
[SWITCH] Broadcast complete for PSN=22
[SWITCH] conn_id=1: Received packet PSN=23, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=23
[SWITCH] Broadcast complete for PSN=23
[SWITCH] conn_id=1: Received packet PSN=47, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=47 from conn 1
[SWITCH] forwarding: psn=47, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=47, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=47, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=47, send_PSN=28 via conn 1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=48, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=48 from conn 1
[SWITCH] forwarding: psn=48, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=48, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=48, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=48, send_PSN=29 via conn 1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=49, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=49 from conn 1
[SWITCH] forwarding: psn=49, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=49, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=49, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=49, send_PSN=30 via conn 1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=50, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=50 from conn 1
[SWITCH] forwarding: psn=50, type=1, len=0, out_cnt=1
[SWITCH] aggregate: conn_id=1, PSN=50, len=256, degree=2/2, op_type=2, root_rank=1
[SWITCH] Aggregation complete for PSN=50, op_type=2
[SWITCH] Reduce: sending to root_rank=1, recv_PSN=50, send_PSN=31 via conn 1
[SWITCH] Reduce result sent to rank 1 via conn 1
[SWITCH] conn_id=1: Received packet PSN=24, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=24
[SWITCH] Broadcast complete for PSN=24
[SWITCH] conn_id=1: Received packet PSN=25, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=25
[SWITCH] Broadcast complete for PSN=25
[SWITCH] conn_id=1: Received packet PSN=26, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=26
[SWITCH] Broadcast complete for PSN=26
[SWITCH] conn_id=1: Received packet PSN=27, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=2, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Upstream ACK from conn 1 for PSN=27
[SWITCH] Broadcast complete for PSN=27
[SWITCH] conn_id=0: Received packet PSN=51, opcode=0x05
[SWITCH] Immediate Data: imm=0xFFFF1000, dest_rank=65535, prim=0, op=1, dtype=0
[SWITCH] Parsed: operation_type=1, root_rank=-1, is_control=1, ctrl_psn=51
[SWITCH] Control message received from conn 0, PSN=51
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] forwarding: psn=51, type=1, len=0, out_cnt=2
[SWITCH] conn_id=1: Received packet PSN=28, opcode=0x11
[SWITCH] Control message ACK sent, ePSN[0] updated to 52
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=28
[SWITCH] Broadcast complete for PSN=28
[SWITCH] conn_id=1: Received packet PSN=29, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=29
[SWITCH] Broadcast complete for PSN=29
[SWITCH] conn_id=1: Received packet PSN=30, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=30
[SWITCH] Broadcast complete for PSN=30
[SWITCH] conn_id=1: Received packet PSN=31, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=31
[SWITCH] Broadcast complete for PSN=31
[SWITCH] conn_id=1: Received packet PSN=51, opcode=0x05
[SWITCH] Immediate Data: imm=0xFFFF1000, dest_rank=65535, prim=0, op=1, dtype=0
[SWITCH] Parsed: operation_type=1, root_rank=-1, is_control=1, ctrl_psn=51
[SWITCH] Control message received from conn 1, PSN=51
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] forwarding: psn=51, type=1, len=0, out_cnt=2
[SWITCH] Control message ACK sent, ePSN[1] updated to 52
[SWITCH] conn_id=0: Received packet PSN=52, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=52 from conn 0
[SWITCH] forwarding: psn=52, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=52, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=53, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=53 from conn 0
[SWITCH] forwarding: psn=53, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=53, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=54, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=54 from conn 0
[SWITCH] forwarding: psn=54, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=54, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=55, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=55 from conn 0
[SWITCH] forwarding: psn=55, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=55, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=56, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=56 from conn 0
[SWITCH] forwarding: psn=56, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=56, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=57, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=57 from conn 0
[SWITCH] forwarding: psn=57, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=57, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=58, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=58 from conn 0
[SWITCH] forwarding: psn=58, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=58, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=0: Received packet PSN=59, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=59 from conn 0
[SWITCH] forwarding: psn=59, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=59, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=52, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=52 from conn 1
[SWITCH] forwarding: psn=52, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=52, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=52, op_type=1
[SWITCH] AllReduce: broadcasting PSN=52
[SWITCH] Broadcasting to conn 0: recv_PSN=52, send_PSN=32
[SWITCH] Broadcasting to conn 1: recv_PSN=52, send_PSN=32
[SWITCH] conn_id=1: Received packet PSN=53, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=53 from conn 1
[SWITCH] forwarding: psn=53, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=53, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=53, op_type=1
[SWITCH] AllReduce: broadcasting PSN=53
[SWITCH] Broadcasting to conn 0: recv_PSN=53, send_PSN=33
[SWITCH] Broadcasting to conn 1: recv_PSN=53, send_PSN=33
[SWITCH] conn_id=1: Received packet PSN=54, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=54 from conn 1
[SWITCH] forwarding: psn=54, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=54, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=54, op_type=1
[SWITCH] AllReduce: broadcasting PSN=54
[SWITCH] Broadcasting to conn 0: recv_PSN=54, send_PSN=34
[SWITCH] Broadcasting to conn 1: recv_PSN=54, send_PSN=34
[SWITCH] conn_id=1: Received packet PSN=55, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=55 from conn 1
[SWITCH] forwarding: psn=55, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=55, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=55, op_type=1
[SWITCH] AllReduce: broadcasting PSN=55
[SWITCH] Broadcasting to conn 0: recv_PSN=55, send_PSN=35
[SWITCH] Broadcasting to conn 1: recv_PSN=55, send_PSN=35
[SWITCH] conn_id=1: Received packet PSN=56, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=56 from conn 1
[SWITCH] forwarding: psn=56, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=56, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=56, op_type=1
[SWITCH] AllReduce: broadcasting PSN=56
[SWITCH] Broadcasting to conn 0: recv_PSN=56, send_PSN=36
[SWITCH] conn_id=0: Received packet PSN=32, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=32
[SWITCH] Broadcasting to conn 1: recv_PSN=56, send_PSN=36
[SWITCH] conn_id=1: Received packet PSN=57, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=57 from conn 1
[SWITCH] forwarding: psn=57, type=1, len=0, out_cnt=2
[SWITCH] conn_id=0: Received packet PSN=33, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=33
[SWITCH] aggregate: conn_id=1, PSN=57, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=57, op_type=1
[SWITCH] AllReduce: broadcasting PSN=57
[SWITCH] Broadcasting to conn 0: recv_PSN=57, send_PSN=37
[SWITCH] Broadcasting to conn 1: recv_PSN=57, send_PSN=37
[SWITCH] conn_id=0: Received packet PSN=34, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=34
[SWITCH] conn_id=1: Received packet PSN=58, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=58 from conn 1
[SWITCH] forwarding: psn=58, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=58, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=58, op_type=1
[SWITCH] AllReduce: broadcasting PSN=58
[SWITCH] Broadcasting to conn 0: recv_PSN=58, send_PSN=38
[SWITCH] Broadcasting to conn 1: recv_PSN=58, send_PSN=38
[SWITCH] conn_id=1: Received packet PSN=59, opcode=0x02
[SWITCH] conn_id=0: Received packet PSN=35, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=59 from conn 1
[SWITCH] forwarding: psn=59, type=1, len=0, out_cnt=2
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=35
[SWITCH] aggregate: conn_id=1, PSN=59, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=59, op_type=1
[SWITCH] AllReduce: broadcasting PSN=59
[SWITCH] Broadcasting to conn 0: recv_PSN=59, send_PSN=39
[SWITCH] Broadcasting to conn 1: recv_PSN=59, send_PSN=39
[SWITCH] conn_id=1: Received packet PSN=32, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=32
[SWITCH] Broadcast complete for PSN=32
[SWITCH] conn_id=1: Received packet PSN=33, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=33
[SWITCH] Broadcast complete for PSN=33
[SWITCH] conn_id=1: Received packet PSN=34, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=34
[SWITCH] Broadcast complete for PSN=34
[SWITCH] conn_id=0: Received packet PSN=60, opcode=0x00
[SWITCH] conn_id=1: Received packet PSN=35, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=60 from conn 0
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=35
[SWITCH] Broadcast complete for PSN=35
[SWITCH] conn_id=1: Received packet PSN=60, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=60 from conn 1
[SWITCH] forwarding: psn=60, type=1, len=0, out_cnt=2
[SWITCH] forwarding: psn=60, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=60, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=61, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=61 from conn 1
[SWITCH] forwarding: psn=61, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=60, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=60, op_type=1
[SWITCH] AllReduce: broadcasting PSN=60
[SWITCH] Broadcasting to conn 0: recv_PSN=60, send_PSN=40
[SWITCH] aggregate: conn_id=1, PSN=61, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] Broadcasting to conn 1: recv_PSN=60, send_PSN=40
[SWITCH] conn_id=1: Received packet PSN=62, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=62 from conn 1
[SWITCH] forwarding: psn=62, type=1, len=0, out_cnt=2
[SWITCH] conn_id=0: Received packet PSN=61, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=61 from conn 0
[SWITCH] forwarding: psn=61, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=62, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=63, opcode=0x02
[SWITCH] aggregate: conn_id=0, PSN=61, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=63 from conn 1
[SWITCH] forwarding: psn=63, type=1, len=0, out_cnt=2
[SWITCH] Aggregation complete for PSN=61, op_type=1
[SWITCH] AllReduce: broadcasting PSN=61
[SWITCH] Broadcasting to conn 0: recv_PSN=61, send_PSN=41
[SWITCH] aggregate: conn_id=1, PSN=63, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=36, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=36
[SWITCH] Broadcasting to conn 1: recv_PSN=61, send_PSN=41
[SWITCH] conn_id=1: Received packet PSN=37, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=37
[SWITCH] conn_id=1: Received packet PSN=38, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] conn_id=0: Received packet PSN=62, opcode=0x01
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=38
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=62 from conn 0
[SWITCH] forwarding: psn=62, type=1, len=0, out_cnt=2
[SWITCH] conn_id=1: Received packet PSN=39, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=39
[SWITCH] aggregate: conn_id=0, PSN=62, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=62, op_type=1
[SWITCH] conn_id=1: Received packet PSN=64, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=64 from conn 1
[SWITCH] forwarding: psn=64, type=1, len=0, out_cnt=2
[SWITCH] AllReduce: broadcasting PSN=62
[SWITCH] Broadcasting to conn 0: recv_PSN=62, send_PSN=42
[SWITCH] aggregate: conn_id=1, PSN=64, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=65, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=65 from conn 1
[SWITCH] forwarding: psn=65, type=1, len=0, out_cnt=2
[SWITCH] Broadcasting to conn 1: recv_PSN=62, send_PSN=42
[SWITCH] aggregate: conn_id=1, PSN=65, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=66, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=66 from conn 1
[SWITCH] forwarding: psn=66, type=1, len=0, out_cnt=2
[SWITCH] conn_id=0: Received packet PSN=63, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=63 from conn 0
[SWITCH] forwarding: psn=63, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=1, PSN=66, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=67, opcode=0x02
[SWITCH] aggregate: conn_id=0, PSN=63, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=63, op_type=1
[SWITCH] AllReduce: broadcasting PSN=63
[SWITCH] Broadcasting to conn 0: recv_PSN=63, send_PSN=43
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Broadcasting to conn 1: recv_PSN=63, send_PSN=43
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=67 from conn 1
[SWITCH] forwarding: psn=67, type=1, len=0, out_cnt=2
[SWITCH] conn_id=0: Received packet PSN=36, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=36
[SWITCH] Broadcast complete for PSN=36
[SWITCH] conn_id=0: Received packet PSN=37, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=37
[SWITCH] Broadcast complete for PSN=37
[SWITCH] aggregate: conn_id=1, PSN=67, len=256, degree=1/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=40, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=40
[SWITCH] conn_id=1: Received packet PSN=41, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] conn_id=0: Received packet PSN=38, opcode=0x11
[SWITCH] Upstream ACK from conn 1 for PSN=41
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=38
[SWITCH] Broadcast complete for PSN=38
[SWITCH] conn_id=0: Received packet PSN=39, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=39
[SWITCH] Broadcast complete for PSN=39
[SWITCH] conn_id=0: Received packet PSN=64, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=64 from conn 0
[SWITCH] forwarding: psn=64, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=64, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=64, op_type=1
[SWITCH] AllReduce: broadcasting PSN=64
[SWITCH] Broadcasting to conn 0: recv_PSN=64, send_PSN=44
[SWITCH] Broadcasting to conn 1: recv_PSN=64, send_PSN=44
[SWITCH] conn_id=0: Received packet PSN=65, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=65 from conn 0
[SWITCH] forwarding: psn=65, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=65, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=65, op_type=1
[SWITCH] AllReduce: broadcasting PSN=65
[SWITCH] Broadcasting to conn 0: recv_PSN=65, send_PSN=45
[SWITCH] Broadcasting to conn 1: recv_PSN=65, send_PSN=45
[SWITCH] conn_id=0: Received packet PSN=66, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=66 from conn 0
[SWITCH] forwarding: psn=66, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=66, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] Aggregation complete for PSN=66, op_type=1
[SWITCH] AllReduce: broadcasting PSN=66
[SWITCH] Broadcasting to conn 0: recv_PSN=66, send_PSN=46
[SWITCH] Broadcasting to conn 1: recv_PSN=66, send_PSN=46
[SWITCH] conn_id=0: Received packet PSN=67, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=67 from conn 0
[SWITCH] forwarding: psn=67, type=1, len=0, out_cnt=2
[SWITCH] aggregate: conn_id=0, PSN=67, len=256, degree=2/2, op_type=1, root_rank=-1
[SWITCH] conn_id=1: Received packet PSN=42, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=42
[SWITCH] conn_id=1: Received packet PSN=43, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=43
[SWITCH] Aggregation complete for PSN=67, op_type=1
[SWITCH] AllReduce: broadcasting PSN=67
[SWITCH] Broadcasting to conn 0: recv_PSN=67, send_PSN=47
[SWITCH] Broadcasting to conn 1: recv_PSN=67, send_PSN=47
[SWITCH] conn_id=0: Received packet PSN=40, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=40
[SWITCH] Broadcast complete for PSN=40
[SWITCH] conn_id=0: Received packet PSN=41, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=41
[SWITCH] Broadcast complete for PSN=41
[SWITCH] conn_id=0: Received packet PSN=42, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=42
[SWITCH] Broadcast complete for PSN=42
[SWITCH] conn_id=0: Received packet PSN=43, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=43
[SWITCH] Broadcast complete for PSN=43
[SWITCH] conn_id=1: Received packet PSN=44, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=44
[SWITCH] conn_id=0: Received packet PSN=44, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=44
[SWITCH] Broadcast complete for PSN=44
[SWITCH] conn_id=0: Received packet PSN=45, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=45
[SWITCH] conn_id=1: Received packet PSN=45, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=45
[SWITCH] Broadcast complete for PSN=45
[SWITCH] conn_id=1: Received packet PSN=46, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=46
[SWITCH] conn_id=0: Received packet PSN=46, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=46
[SWITCH] Broadcast complete for PSN=46
[SWITCH] conn_id=1: Received packet PSN=47, opcode=0x11
[SWITCH] conn_id=0: Received packet PSN=47, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=1, param=-1
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=1, param=-1
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 1 for PSN=47
[SWITCH] Rule found: direction=0, root=1, out_cnt=2
[SWITCH] Upstream ACK from conn 0 for PSN=47
[SWITCH] Broadcast complete for PSN=47
[SWITCH] conn_id=0: Received packet PSN=68, opcode=0x05
[SWITCH] Immediate Data: imm=0x00009000, dest_rank=0, prim=2, op=1, dtype=0
[SWITCH] Parsed: operation_type=3, root_rank=0, is_control=1, ctrl_psn=68
[SWITCH] Control message received from conn 0, PSN=68
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] forwarding: psn=68, type=1, len=0, out_cnt=1
[SWITCH] Control message ACK sent, ePSN[0] updated to 69
[SWITCH] conn_id=0: Received packet PSN=69, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=69 from conn 0
[SWITCH] forwarding: psn=69, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=69, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=69, send_PSN=48
[SWITCH] Broadcast complete for PSN=69
[SWITCH] conn_id=0: Received packet PSN=70, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=70 from conn 0
[SWITCH] forwarding: psn=70, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=70, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=70, send_PSN=49
[SWITCH] Broadcast complete for PSN=70
[SWITCH] conn_id=0: Received packet PSN=71, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=71 from conn 0
[SWITCH] forwarding: psn=71, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=71, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=71, send_PSN=50
[SWITCH] Broadcast complete for PSN=71
[SWITCH] conn_id=0: Received packet PSN=72, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=72 from conn 0
[SWITCH] forwarding: psn=72, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=72, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=72, send_PSN=51
[SWITCH] Broadcast complete for PSN=72
[SWITCH] conn_id=0: Received packet PSN=73, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=73 from conn 0
[SWITCH] forwarding: psn=73, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=73, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=73, send_PSN=52
[SWITCH] Broadcast complete for PSN=73
[SWITCH] conn_id=0: Received packet PSN=74, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=74 from conn 0
[SWITCH] forwarding: psn=74, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=74, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=74, send_PSN=53
[SWITCH] Broadcast complete for PSN=74
[SWITCH] conn_id=0: Received packet PSN=75, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=75 from conn 0
[SWITCH] forwarding: psn=75, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=75, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=75, send_PSN=54
[SWITCH] Broadcast complete for PSN=75
[SWITCH] conn_id=0: Received packet PSN=76, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=76 from conn 0
[SWITCH] forwarding: psn=76, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=76, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=76, send_PSN=55
[SWITCH] Broadcast complete for PSN=76
[SWITCH] conn_id=1: Received packet PSN=48, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=49, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=50, opcode=0x11
[SWITCH] conn_id=0: Received packet PSN=77, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] conn_id=1: Received packet PSN=51, opcode=0x11
[SWITCH] Upstream data PSN=77 from conn 0
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] forwarding: psn=77, type=1, len=0, out_cnt=1
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=52, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=77, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=77, send_PSN=56
[SWITCH] Broadcast complete for PSN=77
[SWITCH] conn_id=0: Received packet PSN=78, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=78 from conn 0
[SWITCH] forwarding: psn=78, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=78, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=78, send_PSN=57
[SWITCH] Broadcast complete for PSN=78
[SWITCH] conn_id=0: Received packet PSN=79, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=79 from conn 0
[SWITCH] forwarding: psn=79, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=79, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=79, send_PSN=58
[SWITCH] conn_id=1: Received packet PSN=53, opcode=0x11
[SWITCH] Broadcast complete for PSN=79
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=0: Received packet PSN=80, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] conn_id=1: Received packet PSN=54, opcode=0x11
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] Upstream data PSN=80 from conn 0
[SWITCH] No rule found for packet from conn 1
[SWITCH] forwarding: psn=80, type=1, len=0, out_cnt=1
[SWITCH] conn_id=1: Received packet PSN=55, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=80, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=80, send_PSN=59
[SWITCH] Broadcast complete for PSN=80
[SWITCH] conn_id=0: Received packet PSN=81, opcode=0x00
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=81 from conn 0
[SWITCH] forwarding: psn=81, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=81, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=81, send_PSN=60
[SWITCH] Broadcast complete for PSN=81
[SWITCH] conn_id=0: Received packet PSN=82, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=82 from conn 0
[SWITCH] forwarding: psn=82, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=82, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=82, send_PSN=61
[SWITCH] Broadcast complete for PSN=82
[SWITCH] conn_id=0: Received packet PSN=83, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=83 from conn 0
[SWITCH] forwarding: psn=83, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=83, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=83, send_PSN=62
[SWITCH] Broadcast complete for PSN=83
[SWITCH] conn_id=0: Received packet PSN=84, opcode=0x02
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=84 from conn 0
[SWITCH] forwarding: psn=84, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 0 (root_rank=0), PSN=84, len=256
[SWITCH] Broadcast: skipping sender conn 0
[SWITCH] Broadcast: sending to conn 1, recv_PSN=84, send_PSN=63
[SWITCH] Broadcast complete for PSN=84
[SWITCH] conn_id=1: Received packet PSN=56, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=57, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=58, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=59, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=60, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=61, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=62, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=63, opcode=0x11
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=0
[SWITCH] No rule found for packet from conn 1
[SWITCH] conn_id=1: Received packet PSN=68, opcode=0x05
[SWITCH] Immediate Data: imm=0x00019000, dest_rank=1, prim=2, op=1, dtype=0
[SWITCH] Parsed: operation_type=3, root_rank=1, is_control=1, ctrl_psn=68
[SWITCH] Control message received from conn 1, PSN=68
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] forwarding: psn=68, type=1, len=0, out_cnt=1
[SWITCH] Control message ACK sent, ePSN[1] updated to 69
[SWITCH] conn_id=1: Received packet PSN=69, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=69 from conn 1
[SWITCH] forwarding: psn=69, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=69, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=69, send_PSN=48
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=69
[SWITCH] conn_id=1: Received packet PSN=70, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=70 from conn 1
[SWITCH] forwarding: psn=70, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=70, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=70, send_PSN=49
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=70
[SWITCH] conn_id=1: Received packet PSN=71, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=71 from conn 1
[SWITCH] forwarding: psn=71, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=71, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=71, send_PSN=50
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=71
[SWITCH] conn_id=1: Received packet PSN=72, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=72 from conn 1
[SWITCH] forwarding: psn=72, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=72, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=72, send_PSN=51
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=72
[SWITCH] conn_id=1: Received packet PSN=73, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=73 from conn 1
[SWITCH] forwarding: psn=73, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=73, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=73, send_PSN=52
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=73
[SWITCH] conn_id=1: Received packet PSN=74, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=74 from conn 1
[SWITCH] forwarding: psn=74, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=74, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=74, send_PSN=53
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=74
[SWITCH] conn_id=1: Received packet PSN=75, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=75 from conn 1
[SWITCH] forwarding: psn=75, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=75, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=75, send_PSN=54
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=75
[SWITCH] conn_id=1: Received packet PSN=76, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=76 from conn 1
[SWITCH] forwarding: psn=76, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=76, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=76, send_PSN=55
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=76
[SWITCH] conn_id=0: Received packet PSN=48, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=49, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=1: Received packet PSN=77, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=77 from conn 1
[SWITCH] forwarding: psn=77, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=77, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=77, send_PSN=56
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=77
[SWITCH] conn_id=1: Received packet PSN=78, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=78 from conn 1
[SWITCH] forwarding: psn=78, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=78, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=78, send_PSN=57
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=78
[SWITCH] conn_id=0: Received packet PSN=50, opcode=0x11
[SWITCH] conn_id=1: Received packet PSN=79, opcode=0x01
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=79 from conn 1
[SWITCH] forwarding: psn=79, type=1, len=0, out_cnt=1
[SWITCH] conn_id=0: Received packet PSN=51, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=52, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=79, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=79, send_PSN=58
[SWITCH] conn_id=0: Received packet PSN=53, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=54, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=79
[SWITCH] conn_id=1: Received packet PSN=80, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=80 from conn 1
[SWITCH] forwarding: psn=80, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=80, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=80, send_PSN=59
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=80
[SWITCH] conn_id=1: Received packet PSN=81, opcode=0x00
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=81 from conn 1
[SWITCH] forwarding: psn=81, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=81, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=81, send_PSN=60
[SWITCH] conn_id=0: Received packet PSN=55, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=81
[SWITCH] conn_id=1: Received packet PSN=82, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=82 from conn 1
[SWITCH] forwarding: psn=82, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=82, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=82, send_PSN=61
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=82
[SWITCH] conn_id=1: Received packet PSN=83, opcode=0x01
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=83 from conn 1
[SWITCH] forwarding: psn=83, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=83, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=83, send_PSN=62
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=83
[SWITCH] conn_id=1: Received packet PSN=84, opcode=0x02
[SWITCH] lookup_rule: src=10.10.0.7, dst=10.10.0.14, prim=3, param=1
[SWITCH] Rule found: direction=0, root=1, out_cnt=1
[SWITCH] Data packet: imm_offset=0, data_len=256
[SWITCH] Upstream data PSN=84 from conn 1
[SWITCH] forwarding: psn=84, type=1, len=0, out_cnt=1
[SWITCH] Broadcast: received from conn 1 (root_rank=1), PSN=84, len=256
[SWITCH] Broadcast: sending to conn 0, recv_PSN=84, send_PSN=63
[SWITCH] Broadcast: skipping sender conn 1
[SWITCH] Broadcast complete for PSN=84
[SWITCH] conn_id=0: Received packet PSN=56, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=57, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=58, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=59, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=60, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=61, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWITCH] No rule found for packet from conn 0
[SWITCH] conn_id=0: Received packet PSN=62, opcode=0x11
[SWITCH] lookup_rule: src=172.16.0.5, dst=172.16.0.21, prim=3, param=1
[SWI