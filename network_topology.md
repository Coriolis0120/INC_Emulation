# 内网系统网络拓扑文档

生成时间: 2026-01-10
文档版本: 1.0

---

## 1. 网络概览

本系统是一个云环境中的服务器集群内网实验环境，包含以下组件：
- 1个Jump Server（跳板机）
- 1个Controller（控制器）
- 2个虚拟机（vm1, vm2）
- 1个Switch（交换/路由节点）

---

## 2. 管理网络 (192.168.0.0/16)

所有节点通过管理网络互联，用于SSH访问和管理操作。

| 节点名称 | 主机名 | 管理IP (eth0) | 角色/说明 |
|---------|--------|--------------|----------|
| **当前服务器** | INC-Test-4 | **192.168.0.11** | Jump Server/跳板机 |
| controller | INC-Test-3 | 192.168.0.3 | 控制器节点 |
| vm1 | OS-Test-01 | 192.168.0.6 | 虚拟机1 |
| switch | OS-Test-02 | 192.168.0.19 | 交换机/路由节点 |
| vm2 | OS-Test-03 | 192.168.0.24 | 虚拟机2 |

---

## 3. 数据网络接口详情

### 3.1 vm1 (OS-Test-01)
- **eth0**: 192.168.0.6/16 (管理网络)
- **eth1**: 172.16.0.5/16 (数据网络，连接到switch)

### 3.2 vm2 (OS-Test-03)
- **eth0**: 192.168.0.24/16 (管理网络)
- **eth1**: 10.10.0.7/16 (数据网络，连接到switch)

### 3.3 switch (OS-Test-02)
- **eth0**: 192.168.0.19/16 (管理网络)
- **eth1**: 172.16.0.21/16 (数据网络，连接到vm1)
- **eth2**: 10.10.0.14/16 (数据网络，连接到vm2)

### 3.4 controller (INC-Test-3)
- **eth0**: 192.168.0.3/16 (管理网络)

### 3.5 Jump Server (INC-Test-4)
- **eth0**: 192.168.0.11/16 (管理网络)

---

## 4. 网络拓扑图

```
                                公网 (Internet)
                                      |
                                      | (虚线连接)
                                      |
                              +---------------+
                              |  Jump Server  |
                              |  INC-Test-4   |
                              | 192.168.0.11  |
                              +---------------+
                                      |
                    ==================|==================
                    服务器内网 (192.168.0.0/16)
                    ==================|==================
                              |       |       |
                    +---------+-------+-------+---------+
                    |         |       |       |         |
            +-------+---+ +---+---+ +-+-----+ +-------+-+
            |Controller| |  vm1  | |switch | |  vm2    |
            |INC-Test-3| |OS-01  | |OS-02  | |OS-03    |
            |.0.3      | |.0.6   | |.0.19  | |.0.24    |
            +----------+ +---+---+ +--+--+-+ +---+-----+
                             |        |  |        |
                             |eth1    |  |        |eth1
                         172.16.0.5   |  |    10.10.0.7
                                      |  |
                                 eth1 |  | eth2
                              172.16.0.21 10.10.0.14
                                      |  |
                         数据平面网络 |  |
                         ============+==+============
```

---

## 5. 网络连接关系

### 5.1 管理平面连接 (192.168.0.0/16)
```
Jump Server (192.168.0.11)
    ├── controller (192.168.0.3)
    ├── vm1 (192.168.0.6)
    ├── switch (192.168.0.19)
    └── vm2 (192.168.0.24)
```

### 5.2 数据平面连接
```
vm1 [172.16.0.5] ←→ switch [172.16.0.21]  (172.16.0.0/16网段)
vm2 [10.10.0.7]  ←→ switch [10.10.0.14]   (10.10.0.0/16网段)
```

---

## 6. 网络连通性测试结果

### 6.1 SSH连接测试
| 节点 | 状态 | 延迟 |
|------|------|------|
| vm1 | ✅ 成功 | <10ms |
| vm2 | ✅ 成功 | <10ms |
| switch | ✅ 成功 | <10ms |
| controller | ✅ 成功 | <10ms |

### 6.2 数据平面连通性
| 源 | 目标 | 丢包率 | 平均延迟 |
|----|------|--------|----------|
| vm1 (172.16.0.5) | switch (172.16.0.21) | 0% | 0.441ms |
| vm2 (10.10.0.7) | switch (10.10.0.14) | 0% | 0.494ms |
| switch (172.16.0.21) | vm1 (172.16.0.5) | 0% | 0.280ms |

### 6.3 管理平面连通性
| 源 | 目标 | 丢包率 | 平均延迟 |
|----|------|--------|----------|
| vm1 (192.168.0.6) | vm2 (192.168.0.24) | 0% | 0.396ms |
| vm1 (192.168.0.6) | controller (192.168.0.3) | 0% | 0.405ms |
| vm1 (192.168.0.6) | switch (192.168.0.19) | 0% | 0.352ms |

---

## 7. SSH配置信息

SSH配置文件位置: `/root/.ssh/config`

```
Host vm1
    HostName 192.168.0.6
    User root
    IdentityFile /root/.ssh/netLab

Host vm2
    HostName 192.168.0.24
    User root
    IdentityFile /root/.ssh/netLab

Host switch
    HostName 192.168.0.19
    User root
    IdentityFile /root/.ssh/netLab

Host controller
    HostName 192.168.0.3
    User root
    IdentityFile /root/.ssh/netLab
```

---

## 8. 网络特点总结

### 8.1 安全特性
- **跳板机隔离**: 外部访问必须通过Jump Server (192.168.0.11)
- **网络分段**: 管理网络和数据网络分离
- **统一认证**: 使用SSH密钥认证 (/root/.ssh/netLab)

### 8.2 架构特点
- **云环境部署**: 整个集群运行在云环境中
- **多网段隔离**: 使用3个不同网段 (192.168.0.0/16, 172.16.0.0/16, 10.10.0.0/16)
- **中心化交换**: switch作为数据平面的中心节点
- **控制器分离**: controller仅连接管理网络，不参与数据转发

### 8.3 性能指标
- **低延迟**: 所有节点间延迟 < 1ms
- **高可靠**: 测试期间无丢包
- **稳定性**: 所有连接正常，无异常

---

## 9. 网络地址分配表

### 9.1 管理网络 (192.168.0.0/16)
| IP地址 | 节点 | 主机名 |
|--------|------|--------|
| 192.168.0.3 | controller | INC-Test-3 |
| 192.168.0.6 | vm1 | OS-Test-01 |
| 192.168.0.11 | Jump Server | INC-Test-4 |
| 192.168.0.19 | switch | OS-Test-02 |
| 192.168.0.24 | vm2 | OS-Test-03 |

### 9.2 数据网络1 (172.16.0.0/16)
| IP地址 | 节点 | 接口 |
|--------|------|------|
| 172.16.0.5 | vm1 | eth1 |
| 172.16.0.21 | switch | eth1 |

### 9.3 数据网络2 (10.10.0.0/16)
| IP地址 | 节点 | 接口 |
|--------|------|------|
| 10.10.0.7 | vm2 | eth1 |
| 10.10.0.14 | switch | eth2 |

---

## 10. 访问路径

### 10.1 外部用户访问路径
```
User (公网) → Jump Server (192.168.0.11) → 内网节点
```

### 10.2 内网节点间通信
```
管理操作: 通过 192.168.0.0/16 网段
数据转发: vm1 ↔ switch ↔ vm2 (通过172.16和10.10网段)
```

---

## 附录: 测试命令

### A.1 查看节点信息
```bash
ssh vm1 "hostname && ip addr show"
ssh vm2 "hostname && ip addr show"
ssh switch "hostname && ip addr show"
ssh controller "hostname && ip addr show"
```

### A.2 测试连通性
```bash
# 测试数据平面
ssh vm1 "ping -c 3 172.16.0.21"
ssh vm2 "ping -c 3 10.10.0.14"

# 测试管理平面
ssh vm1 "ping -c 3 192.168.0.24"
ssh vm1 "ping -c 3 192.168.0.3"
```

---

**文档结束**
